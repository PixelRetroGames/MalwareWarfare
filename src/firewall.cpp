#include "firewall.h"

const SDL_Color COOLDOWN_COLOR={0,0,255},DAMAGE_COLOR={255,0,0},COOLDOWN_COUNTER_COLOR={0,0,255},NAME_COLOR={0,0,0};

void Firewall::Load(char *filename,int _id)
{
 id=_id;
 FILE *in=fopen(filename,"r");
 fscanf(in,"%d %d %d ",&number_of_frames,&health,&ram_cost);
 char path_to_image[TEXT_LENGTH_MAX];
 fgets(path_to_image,sizeof path_to_image,in);
 int sq=strlen(path_to_image);
 if(path_to_image[sq-1]=='\n')
    path_to_image[sq-1]=NULL;
 char name[TEXT_LENGTH_MAX];
 fgets(name,sizeof name,in);
 sq=strlen(name);
 if(name[sq]=='\n')
    name[sq]=NULL;
 fclose(in);
 image=Load_Transparent_Texture(path_to_image);
 menu_image=Create_Transparent_Texture(image->w*2,image->h*2);
 Apply_Stretched_Texture(0,0,menu_image->w,menu_image->h,image,menu_image);
 Texture *cost_image,*health_image,*name_image;
 char aux[TEXT_LENGTH_MAX],aux1[TEXT_LENGTH_MAX];
 name_image=Create_TTF_Texture(MENU_FONT_SMALL,name,NAME_COLOR);
 strcpy(aux1,"Cost: ");
 itoa(ram_cost,aux);
 strcat(aux1,aux);
 cost_image=Create_TTF_Texture(MENU_FONT_SMALL,aux1,COOLDOWN_COLOR);
 strcpy(aux1,"Health: ");
 itoa(health,aux);
 strcat(aux1,aux);
 health_image=Create_TTF_Texture(MENU_FONT_SMALL,aux1,DAMAGE_COLOR);
 menu_description=Create_Transparent_Texture(MENU_OPTION_BACKGROUND->w-2*PIXELS_PER_INGAME_UNIT,name_image->h+cost_image->h+health_image->h+30);
 Apply_Texture((menu_description->w-name_image->w)/2,0,name_image,menu_description);
 Apply_Texture((menu_description->w-health_image->w)/2,name_image->h+10,health_image,menu_description);
 Apply_Texture((menu_description->w-cost_image->w)/2,name_image->h+health_image->h+20,cost_image,menu_description);
 Destroy_Texture(cost_image);
 Destroy_Texture(health_image);
 Destroy_Texture(name_image);
}

void Firewall::Clear()
{
 Clear_menu_images();
 health=ram_cost=0;
}

int Firewall::Get_health()
{
 return health;
}

int Firewall::Get_ram_cost()
{
 return ram_cost;
}
